!function(e){var t={};function i(n){if(t[n])return t[n].exports;var s=t[n]={i:n,l:!1,exports:{}};return e[n].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)i.d(n,s,function(t){return e[t]}.bind(null,s));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=5)}([function(e,t,i){"use strict";i.r(t),i.d(t,"init",(function(){return r})),i.d(t,"configPanel",(function(){return a}));var n=i(1),s=i(2),o=i(3);const r={blockSize:25,rows:20,columns:10,timerCountPrecision:10,timerDisplayPrecision:1e3,speedArray:[2360,1460,920,590,388,259.8,177.5,123.6,87.9,63.61,46.93,35.256,26.977,21.017,16.67],devMode:!1,deletionAnimationSpeed:500,previewSize:4,gameMode:{enduro:{increaseSpeedValue:1,linesToIncreaseSpeed:10,initSpeed:3,display(){document.getElementById("timerBox").classList.add("hide"),document.getElementById("timerTitle").classList.add("hide"),document.getElementById("scoreBox").classList.remove("hide"),document.getElementById("scoreTitle").classList.remove("hide")},init(){n.game.speed=this.initSpeed,this.display()},start(){},pause:()=>!1,lineCheck(e){e.some((e,t)=>(n.game.lines+t+1)%this.linesToIncreaseSpeed==0&&n.game.lines>0)&&n.game.increaseSpeed(this.increaseSpeedValue)},end:()=>!1,displayScore(){o.display.endGame(!0,"GAME END",n.game.gameScore)}},rush:{initSpeed:6,initTimer:60,increaseSpeedValue:1,linesToIncreaseSpeed:5,display(){document.getElementById("timerBox").classList.remove("hide"),document.getElementById("timerTitle").classList.remove("hide"),document.getElementById("scoreBox").classList.remove("hide"),document.getElementById("scoreTitle").classList.remove("hide")},init(){n.game.speed=this.initSpeed,s.a.value=this.initTimer,s.a.pause(),this.display()},start(){s.a.decrement(),s.a.display()},pause(){s.a.pause()},lineCheck(e){e.some((e,t)=>(n.game.lines+t+1)%this.linesToIncreaseSpeed==0&&n.game.lines>0)&&n.game.increaseSpeed(this.increaseSpeedValue)},end:()=>s.a.value<=0&&(s.a.pause(),n.game.stop(),n.game.gameStatut="end",!0),displayScore(){o.display.endGame(!0,"TIME OUT!",n.game.gameScore,"points")}},sprint:{initSpeed:6,increaseSpeedValue:1,linesToIncreaseSpeed:5,initTimer:0,linesToWin:20,display(){document.getElementById("timerBox").classList.remove("hide"),document.getElementById("timerTitle").classList.remove("hide"),document.getElementById("scoreBox").classList.add("hide"),document.getElementById("scoreTitle").classList.add("hide")},init(){n.game.speed=this.initSpeed,s.a.value=this.initTimer,s.a.pause(),this.display()},start(){s.a.increment(),s.a.display()},pause(){s.a.pause()},lineCheck(e){e.some((e,t)=>(n.game.lines+t+1)%this.linesToIncreaseSpeed==0&&n.game.lines>0)&&n.game.increaseSpeed(this.increaseSpeedValue)},end(){return n.game.lines>=this.linesToWin&&(s.a.pause(),n.game.stop(),n.game.gameStatut="end",!0)},displayScore(){o.display.endGame(!0,this.linesToWin+" LINES DONE!",s.a.value,"seconds")}}}},a={}},function(e,t,i){"use strict";i.r(t),i.d(t,"game",(function(){return y}));var n=i(0),s=i(2);const o={blocks:[],preview:[],deletingAnimation:"init",generatePlaygroundGrid(){const e=document.getElementById("playground"),t=document.querySelector("html");t.style.setProperty("--columns",n.init.columns),t.style.setProperty("--rows",n.init.rows),t.style.setProperty("--block-width",n.init.blockSize+"px");const i=n.init.rows*n.init.columns;for(let t=0;t<i;t++){let i=document.createElement("div");i.className="playgroundBlock",n.init.devMode&&(i.innerHTML=t),e.appendChild(i)}for(let t=0;t<n.init.columns;t++){let t=document.createElement("div");t.className="playgroundBottom taken",e.appendChild(t)}this.blocks=Array.from(document.querySelectorAll(".grid div"))},generatePreviewGrid(){const e=document.getElementById("nextTetrominoBox"),t=Math.pow(n.init.previewSize,2);for(let i=0;i<t;i++){let t=document.createElement("div");t.className="playgroundBlock",n.init.devMode&&(t.innerHTML=i),e.appendChild(t)}this.preview=Array.from(document.querySelectorAll("#nextTetrominoBox div"))},generateSavedGrid(){const e=document.getElementById("savedTetrominoBox"),t=Math.pow(n.init.previewSize,2);for(let i=0;i<t;i++){let t=document.createElement("div");t.className="playgroundBlock",n.init.devMode&&(t.innerHTML=i),e.appendChild(t)}this.saved=Array.from(document.querySelectorAll("#savedTetrominoBox div"))},generateAllGrid(){this.generatePlaygroundGrid(),this.generatePreviewGrid(),this.generateSavedGrid()},cleanPreviewGrid(){this.preview.forEach(e=>e.className="playgroundBlock")},cleanSavedGrid(){this.saved.forEach(e=>e.className="playgroundBlock")},removeGrid(e){const t=document.getElementById(e);for(;t.firstChild;)t.removeChild(t.firstChild)},removeAllGrid(){this.removeGrid("nextTetrominoBox"),this.removeGrid("savedTetrominoBox"),this.removeGrid("playground")},cleanAllGrid(){this.removeGrid("playground"),this.cleanPreviewGrid(),this.cleanSavedGrid()},lineIsMade(){let e=[],t=[];for(let t=0;t<n.init.columns;t++)e.push(t);for(let i=0;i<n.init.rows;i++){e.every(e=>this.blocks[i*n.init.columns+e].classList.contains("taken")||this.blocks[i*n.init.columns+e].classList.contains("tetromino"))&&t.push(i)}return t.length,t},animateDeleteLine(e){for(let t=0;t<n.init.columns;t++)e.forEach(e=>this.blocks[n.init.columns*e+t].className="playgroundBlock taken erasing")},deleteLine(e){for(let t=0;t<e.length;t++){let i=[];for(let s=0;s<e[t]*n.init.columns;s++)i.push(this.blocks[s].className),this.blocks[s].className="playgroundBlock";for(let s=0;s<e[t]*n.init.columns;s++){!this.blocks[s+n.init.columns].className.includes("playgroundBottom")&&(this.blocks[s+n.init.columns].className=i[s])}}}},r={number:0,position:0,rotation:0,current:[],canBeSaved:!0,saved:{},next:{},theTetrominoes:[],theTetrominoesPreview:[],createTetrominoes:e=>[[[1,e+1,2*e+1,3*e+1],[0,1,2,3],[1,e+1,2*e+1,3*e+1],[0,1,2,3]],[[0,e,e+1,e+2],[1,2,e+1,2*e+1],[0,1,2,e+2],[1,e+1,2*e,2*e+1]],[[2,e,e+1,e+2],[1,e+1,2*e+1,2*e+2],[0,1,2,e],[0,1,e+1,2*e+1]],[[1,2,e+1,e+2],[1,2,e+1,e+2],[1,2,e+1,e+2],[1,2,e+1,e+2]],[[1,2,e,e+1],[1,e+1,e+2,2*e+2],[1,2,e,e+1],[1,e+1,e+2,2*e+2]],[[0,1,e+1,e+2],[2,e+1,e+2,2*e+1],[0,1,e+1,e+2],[2,e+1,e+2,2*e+1]],[[1,e,e+1,e+2],[1,e+1,e+2,2*e+1],[0,1,2,e+1],[2,e+1,e+2,2*e+2]]],initPreview(){const e=Math.floor(Math.random()*this.theTetrominoes.length),t=Math.floor(Math.random()*this.theTetrominoes[this.number].length),i=this.theTetrominoesPreview[e][t];this.next={number:e,rotation:t,tetromino:i}},initSaved(){this.saved={number:0,rotation:0,tetromino:[]}},initTetromino(){"notStarted"===y.gameStatut&&(this.theTetrominoes=this.createTetrominoes(n.init.columns),this.theTetrominoesPreview=this.createTetrominoes(n.init.previewSize),this.initPreview()),this.number=this.next.number,this.rotation=this.next.rotation,this.position=Math.floor(n.init.columns/2-1),this.canBeSaved=!0,this.initPreview(),this.current=this.theTetrominoes[this.number][this.rotation]},saveTetromino(){this.saved={number:this.number,rotation:this.rotation,tetromino:this.theTetrominoesPreview[this.number][this.rotation]}},switchSaved(){const e=this.saved;this.saveTetromino(),this.number=e.number,this.rotation=e.rotation,this.current=this.theTetrominoes[this.number][this.rotation],this.position=Math.floor(n.init.columns/2-1),this.canBeSaved=!1},rotateTetromino(e){let t=this.rotation;"right"===e?t++:t--,t>=this.theTetrominoes[this.number].length&&(t=0),t<0&&(t=this.theTetrominoes[this.number].length-1);const i=this.theTetrominoes[this.number][t],s=i.some(e=>o.blocks[this.position+e+n.init.columns].classList.contains("taken")),r=i.some(e=>(e+this.position)%n.init.columns==0),a=i.some(e=>(e+this.position+1)%n.init.columns==0);s||r&&a||(this.undraw(),this.current=i,this.rotation=t,this.draw())},drawPreview(){o.cleanPreviewGrid(),this.next.tetromino.forEach(e=>{o.preview[e].classList.add("tetromino"),o.preview[e].classList.add("colorT"+this.next.number.toString())})},drawSaved(){o.cleanSavedGrid(),this.saved.tetromino.forEach(e=>{o.saved[e].classList.add("tetromino"),o.saved[e].classList.add("colorT"+this.saved.number.toString())})},draw(){this.current.forEach(e=>{o.blocks[this.position+e].classList.add("tetromino"),o.blocks[this.position+e].classList.add("colorT"+this.number.toString())})},drawNew(){this.initTetromino(),this.draw(),this.drawPreview()},undraw(){this.current.forEach(e=>{o.blocks[this.position+e].className="playgroundBlock"})},moveDown(){this.undraw(),this.position+=n.init.columns,this.draw()},smackDown(){for(this.undraw();!this.freeze();)this.position+=n.init.columns;this.draw()},moveLeft(){this.current.some(e=>(e+this.position)%n.init.columns==0)||this.lateralBlock("left")||(this.undraw(),this.position--,this.draw())},pushDown(){"init"===o.deletingAnimation&&(this.freeze()||(this.undraw(),this.position+=n.init.columns,this.draw()))},moveRight(){this.current.some(e=>(e+this.position+1)%n.init.columns==0)||this.lateralBlock("right")||(this.undraw(),this.position++,this.draw())},freeze(){return!!this.current.some(e=>o.blocks[this.position+e+n.init.columns].classList.contains("taken"))&&(this.current.forEach(e=>{o.blocks[e+this.position].classList.add("taken")}),!0)},lateralBlock(e){let t;return t="right"===e?1:-1,this.current.some(e=>o.blocks[this.position+e+t].classList.contains("taken"))}};var a=i(3);let d=37,l=39,m=40,c=38,u=65,h=90,p=69;const g={handleKeyPress(e){"play"===y.gameStatut&&(e.keyCode===d&&r.moveLeft(),e.keyCode===l&&r.moveRight(),e.keyCode===m&&r.pushDown(),e.keyCode===c&&r.smackDown(),e.keyCode===u&&r.rotateTetromino("left"),e.keyCode===h&&r.rotateTetromino("right"),e.keyCode===p&&y.saveTetromino())},handleStart(){y.start()},handleReset(){y.reset()},handleBackMenu(){y.backMenu()},handleStart(){y.start()},setListener(e){e?(document.getElementById("resetButton").addEventListener("click",this.handleReset),document.getElementById("startButton").addEventListener("click",this.handleStart),document.getElementById("backMenu").addEventListener("click",this.handleBackMenu),document.addEventListener("keydown",this.handleKeyPress)):(document.getElementById("resetButton").removeEventListener("click",this.handleReset),document.getElementById("startButton").removeEventListener("click",this.handleReset),document.getElementById("backMenu").removeEventListener("click",this.handleReset),document.removeEventListener("keydown",this.handleKeyPress))}};var v=i(4);const y={gameScore:0,lines:8,timerId:0,gameStatut:"notStarted",gameMode:"",speed:0,init(){o.generateAllGrid(),g.setListener(!0),this.restore()},quit(){this.restore(),o.removeAllGrid(),document.getElementById("startButton").innerHTML="Start Game",g.setListener(!1)},restore(){this.gameScore=0,this.lines=0,n.init.gameMode[this.gameMode].init(),this.updateScore(0),this.gameStatut="notStarted",a.display.endGame(!1),a.display.pause(!1),a.display.sidePanelInfo(),r.initSaved(),o.deletingAnimation="init",clearInterval(this.timerId)},start(){"lost"!==this.gameStatut&&"end"!==this.gameStatut||this.reset(),"notStarted"===this.gameStatut&&r.drawNew(),"pause"===this.gameStatut||"notStarted"===this.gameStatut?(this.timerId=setInterval(this.run.bind(this),n.init.speedArray[this.speed-1]),n.init.gameMode[this.gameMode].start(),document.getElementById("startButton").innerHTML="Pause Game",a.display.pause(!1),this.gameStatut="play"):this.pause()},pause(){this.gameStatut="pause",a.display.pause(!0),n.init.gameMode[this.gameMode].pause(),document.getElementById("startButton").innerHTML="Resume",clearInterval(this.timerId)},reset(){o.cleanAllGrid(),o.generatePlaygroundGrid(),this.restore(),r.initSaved(),this.gameStatut="notStarted",document.getElementById("startButton").innerHTML="Start Game"},backMenu(){this.quit(),v.a.showMenu(!0)},saveTetromino(){r.canBeSaved&&(r.saved.tetromino.length>0?(r.undraw(),r.switchSaved(),r.drawSaved(),r.undraw(),r.draw()):(r.saveTetromino(),r.drawSaved(),r.undraw(),r.drawNew()))},updateScore(){const e=this.lines*this.lines*10;this.gameScore+=e,document.getElementById("score").innerHTML=this.gameScore,document.getElementById("lines").innerHTML=this.lines},increaseSpeed(e){clearInterval(this.timerId),this.speed+=e,this.timerId=setInterval(this.run.bind(this),n.init.speedArray[this.speed-1]),document.getElementById("speed").innerHTML=this.speed},run(){if("onGoing"===o.deletingAnimation)return;if(n.init.gameMode[this.gameMode].end())return void n.init.gameMode[this.gameMode].displayScore();const e=o.lineIsMade(),t=r.freeze();if(t&&e.length&&"done"!==o.deletingAnimation)return n.init.gameMode[this.gameMode].lineCheck(e),this.lines+=e.length,this.updateScore(),o.animateDeleteLine(e),o.deletingAnimation="onGoing",void setTimeout(()=>{o.deletingAnimation="done"},n.init.deletionAnimationSpeed);if(t){o.deleteLine(e),o.deletingAnimation="init",r.drawNew();this.loseCondition()&&(this.stop(),this.gameStatut="lost","enduro"===this.gameMode?a.display.endGame(!0,"GAME END",this.gameScore,"points"):(a.display.endGame(!0,"GAME OVER",null),s.a.pause()))}else r.moveDown()},stop(){clearInterval(this.timerId),document.getElementById("startButton").innerHTML="Restart"},loseCondition:()=>r.current.some(e=>o.blocks[r.position+e].classList.contains("taken"))}},function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i(0);const s={value:0,timerCount:0,timerDisplay:0,display(){this.timerDisplay=setInterval(()=>{let e;e=this.value<=0?0:Math.round(this.value),document.getElementById("timer").innerHTML=e},n.init.timerDisplayPrecision)},increment(){this.timerCount=setInterval(()=>{this.value+=n.init.timerCountPrecision/1e3,this.value=Math.round(1e3*this.value)/1e3},n.init.timerCountPrecision)},decrement(){this.timerCount=setInterval(()=>{this.value-=n.init.timerCountPrecision/1e3,this.value=Math.round(1e3*this.value)/1e3},n.init.timerCountPrecision)},pause(){clearInterval(this.timerCount),clearInterval(this.timerDisplay)}}},function(e,t,i){"use strict";i.r(t),i.d(t,"display",(function(){return o}));var n=i(1),s=i(2);const o={playgroundPanel(e){e?(document.getElementById("sidePanelRight").classList.remove("hide"),document.getElementById("sidePanelLeft").classList.remove("hide"),document.getElementById("playgroundContainer").classList.remove("hide")):(document.getElementById("sidePanelRight").classList.add("hide"),document.getElementById("sidePanelLeft").classList.add("hide"),document.getElementById("playgroundContainer").classList.add("hide"))},mainMenu(e){e?document.getElementById("mainMenu").classList.remove("hide"):document.getElementById("mainMenu").classList.add("hide")},sidePanelInfo(){document.getElementById("speed").innerHTML=n.game.speed.toString(),document.getElementById("timer").innerHTML=Math.floor(s.a.value)},endGame(e,t="GAME OVER",i,n){const s=e?"flex":"none";document.getElementById("endGame").style.display=s,e&&(document.getElementById("endGameTitle").innerHTML=t,i>=0&&(document.getElementById("finalScore").innerHTML=i),n&&(document.getElementById("scoreUnit").innerHTML=n))},pause(e){const t=e?"block":"none";document.getElementById("gamePaused").style.display=t}}},function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));i(2);const{display:n}=i(3),{game:s}=i(1),{init:o}=i(0),r={showMenu(e){n.mainMenu(e),n.playgroundPanel(!e)},enduranceMode(){this.showMenu(!1),s.gameMode="enduro",s.init()},rushMode(){this.showMenu(!1),n.mainMenu(!1),n.playgroundPanel(!0),s.gameMode="rush",s.init()},sprintMode(){this.showMenu(!1),n.mainMenu(!1),n.playgroundPanel(!0),s.gameMode="sprint",s.init()}}},function(e,t,i){"use strict";i.r(t);var n=i(4);document.getElementById("enduranceMode").addEventListener("click",()=>n.a.enduranceMode()),document.getElementById("rushMode").addEventListener("click",()=>n.a.rushMode()),document.getElementById("sprintMode").addEventListener("click",()=>n.a.sprintMode())}]);